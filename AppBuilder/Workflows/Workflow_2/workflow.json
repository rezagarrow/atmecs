{
  "Id": 2,
  "Name": "Generate Attractions Template",
  "Description": "",
  "IsDebug": false,
  "ActionList": {
    "Id": 3,
    "EventName": "Event",
    "Actions": [
      {
        "Id": 13,
        "ActionType": "LoadUser",
        "OrderIndex": 0,
        "ActionParameters": [
          {
            "Id": 90,
            "Name": "Id",
            "Value": "1",
            "IsExpression": false,
            "ActionId": 13,
            "OrderIndex": 0,
            "SubParameters": []
          },
          {
            "Id": 91,
            "Name": "Portal",
            "Value": "0",
            "IsExpression": false,
            "ActionId": 13,
            "OrderIndex": 0,
            "SubParameters": []
          }
        ],
        "DiagramUID": "Activity_0c893k0"
      },
      {
        "Id": 5,
        "ActionType": "PlantAnApp.ExecuteWorkflow.1",
        "OrderIndex": 1,
        "ActionParameters": [
          {
            "Id": 34,
            "Name": "InputHelpText",
            "IsExpression": false,
            "ActionId": 5,
            "OrderIndex": 0,
            "SubParameters": []
          },
          {
            "Id": 35,
            "Name": "Id",
            "Value": "[Id]",
            "IsExpression": false,
            "ActionId": 5,
            "OrderIndex": 0,
            "SubParameters": []
          },
          {
            "Id": 36,
            "Name": "prop",
            "Value": "attractions",
            "IsExpression": false,
            "ActionId": 5,
            "OrderIndex": 0,
            "SubParameters": []
          },
          {
            "Id": 37,
            "Name": "OutputHelpText",
            "IsExpression": false,
            "ActionId": 5,
            "OrderIndex": 0,
            "SubParameters": []
          },
          {
            "Id": 38,
            "Name": "PropData",
            "Value": "AttractionsJSON",
            "IsExpression": false,
            "ActionId": 5,
            "OrderIndex": 0,
            "SubParameters": []
          }
        ],
        "DiagramUID": "Activity_1e6ovhv"
      },
      {
        "Id": 10,
        "Description": "",
        "ActionErrorMessage": "",
        "Condition": "",
        "ActionType": "PlantAnApp.ExecuteConditionally",
        "OrderIndex": 2,
        "ActionParameters": [
          {
            "Id": 73,
            "Name": "ConditionedActions",
            "Value": [
              {
                "Condition": {
                  "IsExpression": false,
                  "Expression": "",
                  "Value": "[AttractionsJSON] != \"\""
                },
                "Actions": {
                  "Id": 8,
                  "EventName": "click",
                  "Actions": [
                    {
                      "Id": 12,
                      "ActionType": "PlantAnApp.ReadAllEntity.0.FavoriteAttraction",
                      "OrderIndex": 0,
                      "ActionParameters": [
                        {
                          "Id": 82,
                          "Name": "ConnectionString",
                          "IsExpression": false,
                          "ActionId": 12,
                          "OrderIndex": 0,
                          "SubParameters": []
                        },
                        {
                          "Id": 83,
                          "Name": "Where",
                          "Value": "[User] = '[UserId]'",
                          "IsExpression": false,
                          "ActionId": 12,
                          "OrderIndex": 0,
                          "SubParameters": []
                        },
                        {
                          "Id": 84,
                          "Name": "RowLimit",
                          "Value": "1000",
                          "IsExpression": false,
                          "ActionId": 12,
                          "OrderIndex": 0,
                          "SubParameters": []
                        },
                        {
                          "Id": 85,
                          "Name": "OrderByClauses",
                          "Value": [],
                          "IsExpression": false,
                          "ActionId": 12,
                          "OrderIndex": 0,
                          "SubParameters": []
                        },
                        {
                          "Id": 86,
                          "Name": "OutputToken",
                          "Value": "FavIds",
                          "IsExpression": false,
                          "ActionId": 12,
                          "OrderIndex": 0,
                          "SubParameters": []
                        }
                      ],
                      "DiagramUID": "Activity_16zvz0p"
                    },
                    {
                      "Id": 3,
                      "ActionType": "ExecuteJavascript",
                      "OrderIndex": 1,
                      "ActionParameters": [
                        {
                          "Id": 18,
                          "Name": "ScriptName",
                          "IsExpression": false,
                          "ActionId": 3,
                          "OrderIndex": 0,
                          "SubParameters": []
                        },
                        {
                          "Id": 19,
                          "Name": "LocalVariables",
                          "Value": [
                            {
                              "Type": {
                                "IsExpression": false,
                                "Expression": "",
                                "Value": "string"
                              },
                              "Name": {
                                "IsExpression": false,
                                "Expression": "",
                                "Value": "FavList"
                              },
                              "Value": {
                                "IsExpression": false,
                                "Expression": "",
                                "Value": "[FavIds:JSON]"
                              }
                            },
                            {
                              "Type": {
                                "IsExpression": false,
                                "Expression": "",
                                "Value": "string"
                              },
                              "Name": {
                                "IsExpression": false,
                                "Expression": "",
                                "Value": "User"
                              },
                              "Value": {
                                "IsExpression": false,
                                "Expression": "",
                                "Value": "[UserId]"
                              }
                            }
                          ],
                          "IsExpression": false,
                          "ActionId": 3,
                          "OrderIndex": 0,
                          "SubParameters": [
                            {
                              "Id": 87,
                              "Name": "Type",
                              "Value": "string",
                              "ParentParameterId": 19,
                              "IsExpression": false,
                              "ActionId": 3,
                              "OrderIndex": 0,
                              "SubParameters": []
                            },
                            {
                              "Id": 88,
                              "Name": "Name",
                              "Value": "FavList",
                              "ParentParameterId": 19,
                              "IsExpression": false,
                              "ActionId": 3,
                              "OrderIndex": 0,
                              "SubParameters": []
                            },
                            {
                              "Id": 89,
                              "Name": "Value",
                              "Value": "[FavIds:JSON]",
                              "ParentParameterId": 19,
                              "IsExpression": false,
                              "ActionId": 3,
                              "OrderIndex": 0,
                              "SubParameters": []
                            },
                            {
                              "Id": 142,
                              "Name": "Type",
                              "Value": "string",
                              "ParentParameterId": 19,
                              "IsExpression": false,
                              "ActionId": 3,
                              "OrderIndex": 1,
                              "SubParameters": []
                            },
                            {
                              "Id": 143,
                              "Name": "Name",
                              "Value": "User",
                              "ParentParameterId": 19,
                              "IsExpression": false,
                              "ActionId": 3,
                              "OrderIndex": 1,
                              "SubParameters": []
                            },
                            {
                              "Id": 144,
                              "Name": "Value",
                              "Value": "[UserId]",
                              "ParentParameterId": 19,
                              "IsExpression": false,
                              "ActionId": 3,
                              "OrderIndex": 1,
                              "SubParameters": []
                            }
                          ]
                        },
                        {
                          "Id": 20,
                          "Name": "Code",
                          "Value": "function getLinks(externalLinks){\n\tvar links = ''\n\tObject.keys(externalLinks ?? {}).forEach(function(o){links +=`<p><a href=\"${externalLinks[o][0].url}\">${capitalizeFirstLetter(o)}</a></p>`})\n\treturn links;\n}\n\nfunction capitalizeFirstLetter(string) {\n\treturn string.charAt(0).toUpperCase() + string.slice(1);\n}\n\nfunction favoriteButton(id, favIds){\n\tid(userId != \"\"){\n      if(favIds.indexOf(id) >= 0){\n          return `<a class=\"btn btn-warning fav-${id}\" disabled href=\"javascript:;\">Saved to favorites</a><br><br>`\n      }else{\n          return `<a class=\"btn btn-info fav-${id}\" href=\"javascript:addFavorite('${id}');\">Save to favorites</a><br><br>`\n      }\n    }\n}\n\nvar att = JSON.parse(AttractionsJSON);\nvar favIds = JSON.parse(FavList).map(function(o){ return o.Key });\n\nvar template = ''\natt.forEach(function(at){ \n\ttemplate = \n\t`<h4><b>${at.name}</b></h4>\n    ${favoriteButton(at.id, favIds)}\n    <img src=\"${at.images.filter(obj => {return obj.width == 640 && obj.ratio == '16_9'})[0].url}\">\n\t<div>${getLinks(at.externalLinks)}</div>\n\t<br>\n\t`\n})\n\nreturn template;",
                          "IsExpression": false,
                          "ActionId": 3,
                          "OrderIndex": 0,
                          "SubParameters": []
                        },
                        {
                          "Id": 21,
                          "Name": "OutputTokenName",
                          "Value": "Response",
                          "IsExpression": false,
                          "ActionId": 3,
                          "OrderIndex": 0,
                          "SubParameters": []
                        },
                        {
                          "Id": 22,
                          "Name": "OnError",
                          "Value": {
                            "Id": 4,
                            "EventName": "error",
                            "Actions": []
                          },
                          "IsExpression": false,
                          "ActionId": 3,
                          "OrderIndex": 0,
                          "SubParameters": []
                        }
                      ],
                      "DiagramUID": "Activity_0zqfx2q"
                    }
                  ]
                }
              },
              {
                "Condition": {
                  "IsExpression": false,
                  "Expression": "",
                  "Value": "[AttractionsJSON] == \"\""
                },
                "Actions": {
                  "Id": 9,
                  "EventName": "click",
                  "Actions": [
                    {
                      "Id": 11,
                      "ActionType": "InjectData",
                      "OrderIndex": 0,
                      "ActionParameters": [
                        {
                          "Id": 77,
                          "Name": "Data",
                          "Value": [
                            {
                              "value": "No attractions",
                              "$$hashKey": "object:17",
                              "name": "name"
                            }
                          ],
                          "IsExpression": false,
                          "ActionId": 11,
                          "OrderIndex": 0,
                          "SubParameters": []
                        }
                      ],
                      "DiagramUID": "Activity_0bqdar3"
                    }
                  ]
                }
              }
            ],
            "IsExpression": false,
            "ActionId": 10,
            "OrderIndex": 0,
            "SubParameters": [
              {
                "Id": 74,
                "Name": "Condition",
                "Value": "[AttractionsJSON] != \"\"",
                "ParentParameterId": 73,
                "IsExpression": false,
                "ActionId": 10,
                "OrderIndex": 0,
                "SubParameters": []
              },
              {
                "Id": 75,
                "Name": "Actions",
                "Value": "8",
                "ParentParameterId": 73,
                "IsExpression": false,
                "ActionId": 10,
                "OrderIndex": 0,
                "SubParameters": []
              },
              {
                "Id": 76,
                "Name": "Condition",
                "Value": "[AttractionsJSON] == \"\"",
                "ParentParameterId": 73,
                "IsExpression": false,
                "ActionId": 10,
                "OrderIndex": 1,
                "SubParameters": []
              },
              {
                "Id": 78,
                "Name": "Actions",
                "Value": "9",
                "ParentParameterId": 73,
                "IsExpression": false,
                "ActionId": 10,
                "OrderIndex": 1,
                "SubParameters": []
              }
            ]
          }
        ],
        "DiagramUID": "Gateway_19zp87w"
      }
    ]
  },
  "CreatedBy": "SuperUser Account",
  "CreatedOn": "2021-02-19T12:41:55.8127431+00:00",
  "LastModifiedBy": "SuperUser Account",
  "LastModifiedOn": "2021-02-23T14:47:19.337918+00:00",
  "InputFields": [
    {
      "Required": false,
      "Id": 4,
      "Name": "Id",
      "InputType": "Text",
      "WorkflowId": 2,
      "IsDeleted": false
    },
    {
      "Required": false,
      "Id": 12,
      "Name": "UserId",
      "InputType": "Integer",
      "WorkflowId": 2,
      "IsDeleted": false
    }
  ],
  "OutputFields": [
    {
      "Value": "[Response]",
      "Id": 5,
      "Name": "Template",
      "InputType": "Text",
      "WorkflowId": 2,
      "IsDeleted": false
    },
    {
      "Value": "[AttractionsJSON]",
      "Id": 11,
      "Name": "AttractionsJSON",
      "InputType": "Text",
      "WorkflowId": 2,
      "IsDeleted": false
    },
    {
      "Value": "[FavIds:JSON]",
      "Id": 13,
      "Name": "FavIds",
      "InputType": "Text",
      "WorkflowId": 2,
      "IsDeleted": false
    }
  ]
}